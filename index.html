<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Year Tracker Grid</title>

<style>
:root{
  --border: #d0d0d0;
  --invalid: #c9c9c9;

  --white: #ffffff;
  --green: #9be7a1;
  --orange: #ffb86b;
  --red: #ff6b6b;

  --today-outline: #111;
  --font: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;

  --gap: 2px;
  --label-col: 36px;
  --header-h: 26px;
  --radius: 6px;
  --bw: 1px;
}

body{
  margin: 0;
  padding: 8px;
  font-family: var(--font);
  background: transparent;
  box-sizing: border-box;
}

.square{
  width: min(100%, 920px);
  aspect-ratio: 1 / 1;
  margin: 0 auto;
}

.grid{
  width: 100%;
  height: 100%;
  display: grid;
  grid-template-columns: var(--label-col) repeat(12, 1fr);
  grid-template-rows: var(--header-h) repeat(31, 1fr);
  gap: var(--gap);
}

.corner{ }

.month{
  display:flex;
  align-items:center;
  justify-content:center;
  border: var(--bw) solid var(--border);
  border-radius: var(--radius);
  background:#fff;
  font-weight:600;
  font-size: clamp(10px, 1vw, 13px);
  text-align:center;
  padding:0 2px;
  line-height:1.1;
}

.daylabel{
  display:flex;
  align-items:center;
  justify-content:center;
  border: var(--bw) solid var(--border);
  border-radius: var(--radius);
  background:#fff;
  font-size: clamp(10px, 1vw, 12px);
  font-variant-numeric: tabular-nums;
}

.cell{
  border: var(--bw) solid var(--border);
  border-radius: var(--radius);
  background: var(--white);
  cursor:pointer;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size: clamp(9px, 0.9vw, 11px);
  box-sizing:border-box;
  position:relative;
}

.cell.invalid{
  background: var(--invalid);
  cursor:not-allowed;
  opacity:0.9;
}

.cell.c0{ background: var(--white); }
.cell.c1{ background: var(--green); }
.cell.c2{ background: var(--orange); }
.cell.c3{ background: var(--red); }

.cell.today{
  outline: 2px solid var(--today-outline);
  outline-offset: 0;
}

.cell.today::after{
  content:"";
  position:absolute;
  width:5px;
  height:5px;
  border-radius:50%;
  top:2px;
  right:2px;
  background:var(--today-outline);
  opacity:0.7;
}

.week-sep{
  box-shadow: 0 2px 0 0 #00000018;
}

@media (max-width:520px){
  :root{
    --label-col:30px;
    --header-h:22px;
  }
}
</style>
</head>

<body>
<div class="square">
  <div id="grid" class="grid"></div>
</div>

<script>
(() => {
  const today = new Date();
  const YEAR = today.getFullYear();

  const MONTHS = [
    "January","February","March","April","May","June",
    "July","August","September","October","November","December"
  ];

  const COLORS = ["c0","c1","c2","c3"];
  const STORAGE_KEY = `tracker_square_fullmonths_${YEAR}`;

  const grid = document.getElementById("grid");

  function isLeap(y){
    return (y%4===0 && y%100!==0) || (y%400===0);
  }

  const monthLen = [
    31, isLeap(YEAR)?29:28, 31,30,31,30,
    31,31,30,31,30,31
  ];

  function pad(n){ return String(n).padStart(2,"0"); }
  function key(y,m,d){ return `${y}-${pad(m)}-${pad(d)}`; }

  let state = {};
  try{
    const raw = localStorage.getItem(STORAGE_KEY);
    if(raw) state = JSON.parse(raw) || {};
  }catch{ state = {}; }

  function save(){
    try{ localStorage.setItem(STORAGE_KEY, JSON.stringify(state)); }catch{}
  }

  function build(){
    grid.innerHTML="";

    grid.appendChild(document.createElement("div")); // corner

    for(let m=1;m<=12;m++){
      const h=document.createElement("div");
      h.className="month";
      h.textContent=MONTHS[m-1];
      grid.appendChild(h);
    }

    const todayKey = key(
      today.getFullYear(),
      today.getMonth()+1,
      today.getDate()
    );

    for(let d=1; d<=31; d++){
      const dl=document.createElement("div");
      dl.className="daylabel";
      dl.textContent=d;
      if([7,14,21,28].includes(d)) dl.classList.add("week-sep");
      grid.appendChild(dl);

      for(let m=1;m<=12;m++){
        const cell=document.createElement("div");
        cell.classList.add("cell");

        if(d>monthLen[m-1]){
          cell.classList.add("invalid");
          if([7,14,21,28].includes(d)) cell.classList.add("week-sep");
          grid.appendChild(cell);
          continue;
        }

        const k=key(YEAR,m,d);
        const v=Number.isInteger(state[k])?state[k]:0;
        cell.classList.add(COLORS[v]);

        if(k===todayKey) cell.classList.add("today");
        if([7,14,21,28].includes(d)) cell.classList.add("week-sep");

        cell.addEventListener("click",()=>{
          const cur=Number.isInteger(state[k])?state[k]:0;
          const next=(cur+1)%4;
          state[k]=next;
          cell.classList.remove(...COLORS);
          cell.classList.add(COLORS[next]);
          save();
        });

        grid.appendChild(cell);
      }
    }
  }

  build();
})();
</script>
</body>
</html>
